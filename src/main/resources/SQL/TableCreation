
--####### TABLE CREATION ###################################

CREATE TABLE song (
    id UUID DEFAULT gen_random_uuid(),
    name VARCHAR(255),
    artist_id UUID,
    album_id UUID,
    file_id UUID,
    PRIMARY KEY ( id ));

CREATE TABLE artist(
    id UUID DEFAULT gen_random_uuid(), 
    name VARCHAR(255),
    PRIMARY KEY ( id ));

CREATE TABLE album (
    id UUID DEFAULT gen_random_uuid(),
    name VARCHAR(255),
    artist_id UUID,
    PRIMARY KEY ( id ));

CREATE TABLE playlist(
    id UUID DEFAULT gen_random_uuid(),
    name VARCHAR(255),
    creator_id UUID,
    PRIMARY KEY ( id ));

CREATE TABLE playlistsongs(
    id UUID DEFAULT gen_random_uuid(),
    playlist_id UUID,
    song_id UUID,
    order_num SMALLINT,
    PRIMARY KEY ( id ));

CREATE TABLE user_account(
    id UUID DEFAULT gen_random_uuid(),
    name VARCHAR(255),
    PRIMARY KEY ( id ));

CREATE TABLE password(
    id UUID DEFAULT gen_random_uuid(),
    password_hash VARCHAR(255),
    user_id UUID,
    PRIMARY KEY ( id ));

CREATE TABLE file(
    id UUID DEFAULT gen_random_uuid(),
    file_path VARCHAR(255),
    file_type VARCHAR(255),
    PRIMARY KEY ( id ));


-- ########### RELATIONS #################################

ALTER TABLE song
    ADD FOREIGN KEY (artist_id) REFERENCES artist(id);

ALTER TABLE song
    ADD FOREIGN KEY (album_id) REFERENCES album(id);

ALTER TABLE song
    ADD FOREIGN KEY (file_id) REFERENCES file(id);

ALTER TABLE album
    ADD FOREIGN KEY (artist_id) REFERENCES artist(id);

ALTER TABLE playlist
    ADD FOREIGN KEY (creator_id) REFERENCES user_account(id);

ALTER TABLE playlistsongs
    ADD FOREIGN KEY (playlist_id) REFERENCES playlist(id);

ALTER TABLE playlistsongs
    ADD FOREIGN KEY (song_id) REFERENCES song(id);

ALTER TABLE password
    ADD FOREIGN KEY (user_id) REFERENCES user_account(id);